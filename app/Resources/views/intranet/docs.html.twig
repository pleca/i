{% extends 'intranet/base.html.twig' %}


{%  block body %}

    <link rel="stylesheet" href="{{ asset('telerik/styles/kendo.common.min.css') }}" />
    <link rel="stylesheet" href="{{ asset('telerik/styles/kendo.rtl.min.css') }}" />
    <link rel="stylesheet" href="{{ asset('telerik/styles/kendo.default.min.css') }}" />
    <link rel="stylesheet" href="{{ asset('telerik/styles/kendo.default.mobile.min.css') }}" />
    <script src="{{ asset('telerik/js/jquery.min.js') }}"></script>
    <script src="{{ asset('telerik/js/jszip.min.js') }}"></script>
    <script src="{{ asset('telerik/js/kendo.all.min.js') }}"></script>
    <script src="{{ asset('telerik/js/kendo.timezones.min.js') }}"></script>
    <script src="{{ asset('telerik/js/messages/kendo.messages.pl-PL.min.js') }}"></script>
    <script src="{{ asset('telerik/js/cultures/kendo.culture.pl-PL.min.js') }}"></script>
    <div class="well well-sm"><span class="path"><a href="{{ path('Strona Główna') }}">Strona Główna</a> / {{ app.request.get('_route') }}</span></div>

        <section class="home_grid">
            <h2>Dokumenty</h2>
            <div id="grid"></div>
        </section>

    <hr>

    {% if is_granted('ROLE_ADMIN') %}
    <section class="docs_form">
        <h3>Dodaj plik</h3>
    {{ form_start(form) }}

    {{ form_row(form.DocumentFile) }}
    {{ form_row(form.documentDesc) }}

    {{ form_end(form) }}
    </section>
    {% endif %}


    <script>
        kendo.culture("pl-PL");
        $(document).ready(function () {
            var
                dataSource = new kendo.data.DataSource({

                    transport: {
                        read:  {
                            url: "{{ path('getjsondocs') }}",
                            dataType: "json"
                        },
                        destroy: {
                            url: "{{ path('deletedoc') }}",
                            type: "post",
                            dataType: "json"
                        }
                    },
                    batch: true,
                    pageSize: 40,
                    schema: {
                        model: {
                            id: "documentId",
                            fields: {
                                documentId: { editable: false },
                                documentDesc: { editable: false },
                                documentFile: { editable: false },
                                documentDateAdd: { editable: false },
                                documentDateMod: { editable: false }
                            }
                        }
                    }
                });

            $("#grid").kendoGrid({
                dataSource: dataSource,
                pageable: true,
                selectable: false,
                groupable: true,
                sortable: true,
                columns: [
                    {
                        field: "documentFile",
                        title: "Plik",
                        template: '<a href="files/#=documentFile#" class="home_grid_link">#=documentFileTitle#</a>'
                    },
                    {
                        field: "documentDateAdd",
                        title: "Data Dodania"
                    },
                    {
                        field: "documentDesc",
                        title: "Opis"
                    },
                    {
                        field: "user",
                        title: "Twórca"
                    }
                    {% if is_granted('ROLE_ADMIN') %}
                    ,
                    { command: "destroy",
                        title: "&nbsp;",
                        width: 100
                    }
                    {% endif %}
                ],
                editable: "inline"
            });
        });
    </script>



{% endblock %}